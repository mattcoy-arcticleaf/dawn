{% comment %}
  icon-with-text: only shows items with non-blank headings,
  and only renders the whole block if any heading exists.
{% endcomment %}

{%- liquid
  # Grab prefixes
  assign prefix1 = block.settings.prefix_text_1 | strip
  assign prefix2 = block.settings.prefix_text_2 | strip
  assign prefix3 = block.settings.prefix_text_3 | strip

  # Grab headings, stripping whitespace
  assign h1 = block.settings.heading_1 | strip
  assign h2 = block.settings.heading_2 | strip
  assign h3 = block.settings.heading_3 | strip

  # Only render block if at least one heading is non-blank
  assign render_block = false
  if h1 != '' or h2 != '' or h3 != ''
    assign render_block = true
  endif
-%}

{%- if render_block -%}
<ul class="icon-with-text icon-with-text--{{ block.settings.layout }} list-unstyled"
    {{ block.shopify_attributes }}>

  {%- if h1 != '' -%}
    <li class="icon-with-text__item">
      {%- if block.settings.image_1 -%}
        <img src="{{ block.settings.image_1 | image_url }}" loading="lazy" role="presentation">
      {%- elsif block.settings.icon_1 != 'none' -%}
        {% render 'icon-accordion', icon: block.settings.icon_1 %}
      {%- endif -%}
      <span class="h4 inline-richtext">
        {%- if prefix1 != '' -%}{{ prefix1 }} {% endif -%}{{ h1 }}
      </span>
    </li>
  {%- endif -%}

  {%- if h2 != '' -%}
    <li class="icon-with-text__item">
      {%- if block.settings.image_2 -%}
        <img src="{{ block.settings.image_2 | image_url }}" loading="lazy" role="presentation">
      {%- elsif block.settings.icon_2 != 'none' -%}
        {% render 'icon-accordion', icon: block.settings.icon_2 %}
      {%- endif -%}
      <span class="h4 inline-richtext">
        {%- if prefix2 != '' -%}{{ prefix2 }} {% endif -%}{{ h2 }}
      </span>
    </li>
  {%- endif -%}

  {%- if h3 != '' -%}
    <li class="icon-with-text__item">
      {%- if block.settings.image_3 -%}
        <img src="{{ block.settings.image_3 | image_url }}" loading="lazy" role="presentation">
      {%- elsif block.settings.icon_3 != 'none' -%}
        {% render 'icon-accordion', icon: block.settings.icon_3 %}
      {%- endif -%}
      <span class="h4 inline-richtext">
        {%- if prefix3 != '' -%}{{ prefix3 }} {% endif -%}{{ h3 }}
      </span>
    </li>
  {%- endif -%}

</ul>
{%- endif -%}
